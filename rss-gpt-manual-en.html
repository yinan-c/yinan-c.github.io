<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link rel="stylesheet" href="theme.css" />
    <link rel="stylesheet" href="style.css" />

    
  <title>RSS-GPT Configuration - 1nan</title>


    
  <style>
  img {
    
    max-width: 100% !important;
    
    height: auto !important;
  }
  </style>


  </head>
  <body>
    

<div style="display: flex; justify-content: space-between; align-items: center;">
    <div id="header-created-at">
        <span style="font-size: 0.5 em; color: #888;">2023-09-11 </span>
    </div>

    <div id="header-home-link" style="font-size: 0.5 em;">
        <a href="index.html">&lt; Home</a>
        
        <a href="years.html">&lt; Timeline</a>
        |
        <a href="random.html">Random &gt;</a>
        
    </div>
</div>


    <main>


<h1>RSS-GPT Configuration</h1>
<h2>Introduction</h2>
<ul>
<li><a href="https://github.com/yinan-c/RSS-GPT">yinan-c/RSS-GPT</a></li>
<li><a href="https://yinan-c.github.io/rss-gpt.html">RSS-GPT Introduction</a></li>
<li><a href="https://yinan-c.github.io/rss-gpt-manual-zh.html">中文指南</a></li>
</ul>
<h2>Prerequisites</h2>
<ul>
<li>GitHub account</li>
<li>OpenAI API Key (get it at <a href="https://platform.openai.com/account/api-keys">OpenAI website</a>)</li>
</ul>
<h2>1. GitHub Actions deployment</h2>
<p>The main idea is to use GitHub Actions to run Python scripts periodically, the script calls OpenAI API to generate summaries and append them to original RSS entries, then generate a new xml file, and commit it to the repo.</p>
<p>All contents in the repo folder are deployed on GitHub Pages via GitHub Actions, so you can access the xml file via your GitHub Pages URL, and subscribe to it like normal RSS feeds in any RSS reader.</p>
<p>If you don't want to deploy on GitHub Pages, you can also subscribe to the raw xml file in the repo (URL starts with raw.githubusercontent.com), e.g. the xml file URL of this repo is <a href="https://raw.githubusercontent.com/yinan-c/RSS-GPT/main/rss/brett-terpstra.xml">https://raw.githubusercontent.com/yinan-c/RSS-GPT/main/rss/brett-terpstra.xml</a>.</p>
<h3>1.1 Fork the project, uncheck 'copy only the main branch'</h3>
<p>Go to the project <a href="https://github.com/yinan-c/RSS-GPT">RSS-GPT</a> and fork the repo, uncheck 'copy only the main branch' to copy all branches. This is for separating the workflow auto commit branch from the main branch. Note, in that case, the 'auto-commit' branch will be the working branch that actually generate new xml files and push to your repo and GitHub Pages, <strong>only edits in the 'auto-commit' branch will take effect</strong>.</p>
<p>I did this because I want to keep the main branch clean, so that others can see when the script was actully updated and decided whether to pull the changes.</p>
<p>If you don't mind the main branch having auto-commit edits, you can also just fork the main branch and configure your workflows to commit to the main branch, which I will cover later.</p>
<h3>1.2 Three Repo Secrets</h3>
<h4>U_NAME</h4>
<p>The username used for <code>git commit</code>, <strong>please set to your GitHub username</strong>. Your username is the last part of your GitHub homepage URL, e.g. https://github.com/yinan-c, the username is yinan-c.</p>
<h4>U_EMAIL</h4>
<p>The email used for <code>git commit</code>, it's the email you used to register GitHub, can be found in <a href="https://github.com/settings/emails">GitHub settings page</a>.</p>
<h4>WORK_TOKEN</h4>
<p>Since the project involves using scripts to operate repo contents, permissions are needed for the script to modify files in the repo. Apply for a new personal access token (classic) in <a href="https://github.com/settings/tokens/new">GitHub settings page</a> and configure the new token as follows:</p>
<p><img src="https://yinan.me/pics/token-set.png" alt="" /></p>
<ul>
<li><p>Note: &quot;RSS-GPT&quot; or any name you like</p>
</li>
<li><p>Select scopes: Check all options under &quot;repo&quot; and &quot;workflow&quot;</p>
</li>
<li><p>Expiration: Choose &quot;No expiration&quot;</p>
</li>
<li><p>Click &quot;Generate token&quot; at bottom.</p>
</li>
</ul>
<p><img src="https://yinan.me/pics/token-copy.png" alt="" /></p>
<p><strong>Copy the token after clicking, make sure to copy it on this page, you won't be able to see the token after leaving this page. If you miss it, you'll have to generate a new one following the steps above.</strong></p>
<h3>1.3 Set Repository Secrets</h3>
<p>Go to your forked repo, click &quot;Settings&quot; in top menu bar, then click &quot;Secrets and variables&quot; in left sidebar, choose &quot;Actions&quot;, then click &quot;New repository secret&quot; at top right.</p>
<p><img src="https://yinan.me/pics/secrets.png" alt="" /></p>
<ul>
<li><p>Add <code>U_NAME</code>, <code>U_EMAIL</code>, <code>WORK_TOKEN</code>, <code>OPENAI_API_KEY</code> as secrets to the repo, can only add one at a time:</p>
<ul>
<li><p>Name: U_NAME, U_EMAIL, WORK_TOKEN, OPENAI_API_KEY</p>
</li>
<li><p>Value: Your username, email, the copied GitHub token and OpenAI API Key</p>
</li>
<li><p>Click &quot;Add secret&quot;</p>
</li>
</ul>
</li>
</ul>
<h3>1.4 Grant required permissions</h3>
<p>Enable GitHub Actions access to Pages:</p>
<p><img src="https://yinan.me/pics/pages.png" alt="" /></p>
<ul>
<li><p>Click &quot;Settings&quot;</p>
</li>
<li><p>Find &quot;Pages&quot; under &quot;Code and automation&quot; in left sidebar and click in</p>
</li>
<li><p>Set &quot;Source&quot; as &quot;GitHub Actions&quot;, then click &quot;Save&quot;</p>
</li>
</ul>
<h2>2. Configure RSS sources to merge, filter and summarize</h2>
<p>Go to the project, if you forked both main and auto-commit branches, <strong>switch to the auto-commit branch as below</strong>, other wise skip this step.</p>
<p><img src="https://yinan.me/pics/change_branch.png" alt="" /></p>
<p>Open the &quot;config.ini&quot; file, click the pencil icon at top right to edit code and configure your desired sources. Don't change the first two lines.</p>
<pre><code>[cfg] 
base = &quot;rss/&quot;
</code></pre>
<p>Then modify the <strong>target language, number of keywords, and summary length</strong> in the next 3 lines. The following code is feed-specific configs, format is:</p>
<ul>
<li><p><code>[source001]</code>: Feed ID, starts from 001 and increments, make sure IDs are unique to avoid errors.</p>
</li>
<li><p><code>name = &quot;brett-terpstra&quot;</code>: Name of the generated feed, only letters (a-z A-Z), numbers (0-9), (<code>-</code>,<code>_</code>,<code>.</code>,<code>~</code>) allowed.</p>
</li>
<li><p><code>url = &quot;https://brett.trpstra.net/brettterpstra&quot;</code>: Original RSS feed URL, can contain multiple feeds separated by comma.</p>
</li>
<li><p><code>max_items = &quot;10&quot;</code>: Number of articles to summarize between refreshes. E.g. 10 means summarizing the latest 10 articles on each refresh. 0 means no summarization, returning original entries.</p>
</li>
</ul>
<p>Next are optional filter configs, note all 3 must be set together or not set:</p>
<ul>
<li><p><code>filter_apply = &quot;title&quot;</code>: Apply filter on &quot;title&quot;, &quot;article&quot; (content) or &quot;link&quot;.</p>
</li>
<li><p><code>filter_type = &quot;exclude&quot;</code>: Filter type: &quot;include&quot;, &quot;exclude&quot;, &quot;regex match&quot; or &quot;regex not match&quot;.</p>
</li>
<li><p><code>filter_rule = &quot;TextExpander&quot;</code>: Filter text or regex.</p>
</li>
</ul>
<p>Click &quot;Commit changes&quot; at bottom to submit edits.</p>
<h2>3.1 Modify <code>main.py</code> (if you used default repo name in 1.1, you can skip this step)</h2>
<ul>
<li><p>Open &quot;main.py&quot; file, click the pencil icon to edit code, go to line 290 and modify the &quot;RSS-GPT&quot; in &quot;https://{U_NAME}.github.io/RSS-GPT&quot; to your repo name.</p>
</li>
<li><p>(Optional) Modify prompt at lines 113-129 based on your needs for better summaries.</p>
</li>
<li><p>Click &quot;Commit changes&quot; at bottom to submit edits.</p>
</li>
</ul>
<h2>3.2 Modify <code>cron_job.yml</code> (if you forked &quot;auto-commit&quot; branch in 1.1 and edited auto-commit branch in Step 2, you can skip this step)</h2>
<p>This step is to let GitHub Actions automatically commit to main branch instead of auto-commit branch.</p>
<ul>
<li>Open &quot;.github/workflows/cron_job.yml&quot; file, click the pencil icon to edit code, delete line 15 <code>    if: ${{ github.ref == 'refs/heads/auto-commit' }}</code>, then click &quot;Commit changes&quot; at bottom to submit edits.</li>
<li>Open &quot;.github/workflows/jekyll-gh-pages.yml&quot; file, click the pencil icon to edit code, delete line 28 <code>    if: ${{ github.ref == 'refs/heads/auto-commit' }}</code>, modify line 8 <code>- auto-commit</code> to <code>- main</code>, then click &quot;Commit changes&quot; at bottom to submit edits.</li>
</ul>
<h2>4. Test GitHub Actions</h2>
<p>Go to the project, click &quot;Actions&quot; in top menu bar, click &quot;cron_job&quot; select 'auto-commit' branch and choose &quot;Run workflow&quot;.</p>
<p>Green check mark means successful run, red x means failure, usually due to errors in edited ini file or incorrect permissions/tokens, or the edits are not in the auto-commit branch.</p>
<p>If there are no errors, you should see your feeds on the project README page.</p>
<p>On the left of <code>-&gt;</code> is original URL, right is converted URL to subscribe like any other RSS feeds. Make sure you have changed your username in step 3.</p>
<h2>Some extra notes</h2>
<h3>About feeds refresh frequency</h3>
<ul>
<li>Default run frequency is every 2 hours, modify <code>.github/workflows/cron_job.yml</code> line 7 to change, e.g.</li>
</ul>
<pre><code>   - cron: '0 */2 * * *' # run every 2 hours
   - cron: '0 */1 * * *' # run every 1 hours
   - cron: '0 0 * * *' # run every day at 00:00
   - cron: '*/30 * * * *' # run every 30 minutes
</code></pre>
<p>For more info on cron syntax, see <a href="https://crontab.guru/">crontab docs</a> or <a href="https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#schedule">GitHub docs</a>.</p>
<h3>What if I don't want to use summarization feature?</h3>
<ul>
<li><p>Well, you can still use this script to filter and merge multiple subscription sources. You just need to not set the OpenAI API Key in 1.3, or not set the <code>max_items</code> in <code>config.ini</code>, or set it to 0. By default, this script can also return the original article entries when the AI call fails.</p>
</li>
<li><p>If you do want the AI summarization feature and have correctly set <code>config.ini</code>, but still receive the original entries without summarization or experience infrequent updates, you can check the error information of the OpenAI API or feedparser from the <code>feed_name.log</code> file in the &quot;auto-commit&quot; branch's <code>rss/</code> folder of the project.</p>
</li>
</ul>
<h3>About AI summary Content</h3>
<ul>
<li><p>My prompt is basically asking AI to extract keywords + summarize + auto-formatting. Formatting is not always perfect, and my prompt is not perfectly optmized for everyone. You can modify prompt at lines 113-129 based on your needs.</p>
</li>
<li><p>AI summaries are based on the description of each article in the feed. If the RSS itself provides the full text article, the full text will be summarized; if the RSS only provides the article summary, the summary will be based on the summary, and the script does not currently provide the function of crawling the full text of the original article.</p>
</li>
</ul>
<h3>About the usage of OpenAI API</h3>
<ul>
<li><p>Regarding the usage of the OpenAI API, in order to minimize costs as much as possible, the following default measures have been adopted for this project:</p>
<ul>
<li><p>All unrelevent content (images, frames, HTML tags etc.) are removed before sending to OpenAI API, in order to reduce the token length and cost.</p>
</li>
<li><p>Different models are selected based on text length, and if the text length exceeds 16k, the first 16k characters will be used with GPT-3.5 Turbo 16K.</p>
</li>
<li><p>Considering GPT-4 costs about 10 times more than GPT-3.5 Turbo, GPT-3.5 Turbo is used by default. If you want to use a different model, you can modify the model parameter passed to the <code>gpt_summary</code> function of lines 227-243 of main.py, e.g. <code>model=&quot;your_model&quot;</code>. Please refer to the <a href="https://openai.com/pricing/">OpenAI API Pricing</a> for different prices of different OpenAI models.</p>
</li>
<li><p>The script will read the xml files already existing in the rss/ folder. Existing articles will not be summarized again, so OpenAI API will not be repeatedly consumed.</p>
</li>
</ul>
</li>
</ul>
<h3>About repo updates</h3>
<ul>
<li><p>I have separated manual edits and workflow auto commits into different branches, so you can see when and what I have edited in the main branch to decide whether to pull the latest changes. Note that if you want the edits to take effect, please pull to the working branch, which is the auto-commit branch.</p>
</li>
<li><p>If OpenAI releases more models in the future, I will choose the most suitable default model and update the code accordingly. If you have a better way to use AI or encounter any issues or spotted any errors, feel free to <a href="mailto:yinan.email@gmail.com">email me</a>.</p>
</li>
</ul>



<style>
.nav-button {
  padding: 10px 20px;
  background-color: #F2F2F2; /* Light grey */
  border: none;
  color: black; /* Change text color to black for visibility against transparent background */
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 14px;
  margin: 4px 2px;
  cursor: pointer;
  transition-duration: 0.4s;
  border-radius: 5px;
  width: 48%; /* Set the width to approximately half the page */
  white-space: normal; /* Allow text to wrap onto a new line */
  box-sizing: border-box; /* Include padding and border in element's total width and height */
}


@media (max-width: 600px) {
  .nav-button {
    font-size: 12px;  /* 在小屏幕上减小字体大小 */
  }
}

.nav-button a {
  color: inherit; /* Inherit text color from parent element */
  text-decoration: none;
}

.nav-button:hover {
  background-color: #EAEAEA; /* Dark grey on hover */ 
}

#prev-button {
  float: left;
  text-align: left;
}

#next-button {
  float: right;
  text-align: right;
}
</style>



    <a href="separating-tasks-and-lists.html" class="nav-button" id="prev-button">&lt; Separting tasks and non-actionable items</a>


    <a href="rss-gpt-manual-zh.html" class="nav-button" id="next-button">RSS-GPT 使用指南 &gt;</a>



<br>

<script src="https://giscus.app/client.js"
        data-repo="yinan-c/pages-comment"
        data-repo-id="R_kgDOKTPNKg"
        data-category="Announcements"
        data-category-id="DIC_kwDOKTPNKs4CZSbD"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

</main>
    

<div id="updated-at">
  <span>Created: 2023-09-11</span>
  <span>Updated: 2023-09-20</span>
</div>

<div id="footer">
  <div id="footer-home-link">
    <a href="index.html">&lt; Home</a>
    
    <a href="title-index.html#i52">&lt; Index</a>
    |
    <a href="random.html">Random &gt;</a>
    
  </div>
  <p id="footer-body">
    
    © 2023 <a href = "https://yinan.me/">Yinan</a>
    
    <a href="http://creativecommons.org/licenses/by/4.0/"><img src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by.png" alt="Creative Commons Licence" width="45" style="vertical-align: text-top;" ></a>
    · Powered by <a href="https://github.com/yinan-c/pyboke">PyBoke</a>
    · Subscribe via <a href="atom.xml"> RSS <img src="https://wp-assets.rss.com/blog/wp-content/uploads/2019/10/10111557/social_style_3_rss-512-1.png" alt="RSS" width="15" height="15" style="vertical-align: text-top;"></a>
  </p>
</div>

  </body>

  
</html>